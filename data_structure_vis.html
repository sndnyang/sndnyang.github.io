
<!doctype html>
<html>
<head>
  <title> data structure and algorithm 可视化</title>

  <style type="text/css">
    #datastruct {
      width: 95%;
      height: 400px;
      border: 1px solid lightgray;
    }
  </style>

  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/vis/4.7.0/vis.js"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/vis/4.7.0/vis.css" rel="stylesheet" type="text/css" />

  <script type="text/javascript">
    var nodes = null;
    var edges = null;
    var network = null;
    var stepLog = new Array();
    var index = 0;

    function stepRedraw() {
    // create a network
      var container = document.getElementById('datastruct');
      var data = {
        nodes: nodes,
        edges: edges
      };
      var options = {
          layout: {
              hierarchical:{
                  direction: 'UD'
              }//,
          //physics: {hierarchicalRepulsion: {springConstant: 0}
      }};//physics:{barnesHut:{gravitationalConstant:-4000}}};
      network = new vis.Network(container, data, options);
    }
    
    function next() {
        if (stepLog.length == 0) {
            alert("步骤长度为0， 应该尚未执行算法");
            return;
        }
        
        if (stepLog.length == index) {
            alert("执行完毕");
            return;
        }
        
        var step = stepLog[index];
        if (index > 0) {
            var j = stepLog[index-1].index;
            nodes[j].color = "orange";
            nodes[j-1].color = "orange";
        }
        
        var j = step.index;
        
        nodes[j].color = "red";
        nodes[j-1].color = "red";
        
        var data = {
            nodes: nodes,
            edges: edges
        };
                
        if (step.swap == true) {
            var label = nodes[j].label;
            nodes[j].label = nodes[j-1].label;
            nodes[j-1].label = label;
        }
        
        network.setData(data);
        network.redraw();
        index++;
    }
    
    function start() {
        var len = nodes.length;
        
        var v = new Array();
        
        for (var i = 0; i < len; i++) {
            v.push(nodes[i].label);
        }
        
        for (var i = 0; i < len; i++) {
            for (var j = 1; j < len-i; j++) {
                var step = {index:j};
                if (v[j] < v[j-1]) {
                    step.swap = true;
                    var tmp = v[j];
                    v[j] = v[j-1];
                    v[j-1] = tmp;
                }
                else {
                    step.swap = false
                }
                stepLog.push(step);
            }
        }
        console.log('log size ' + stepLog.length);
        console.log(v);
        
        index = 0;
    }
    
    function draw() {
        var len = document.getElementById('lenth').value;
        nodes = new Array();
        
        for (var i = 0; i < len; i++) {
            var node = {id: i+1,  font:{size:10}, 
                fixed: {x:true, y:true }, 
                label: Math.floor(Math.random()*100), 
                shape: 'square', 
                color: 'orange'
            };
            nodes.push(node);
        }

      edges = [
      ];
      stepRedraw(nodes, edges);
    }
  </script>
<body onload="draw()">

    <p>
      数据结构和算法 可视化练习 基础， 试排序， 输入数组长度（20以内）
    </p>

    数组长度：
    <input type="text" id="lenth" value="10" onkeydown="javascript:if (event.keyCode==13) draw();"/>
    <div id="datastruct"></div>

    <select id="sortAlgo" onblur="start()">
		<option value ="bubble">冒泡</option>
		<option value ="quick">快排</option>
	  	<option value ="merge">归并</option>
	  	<option value ="select">选择</option>
	</select>
    <input type="submit" value="算法运行" onclick="start()"/>
    <input type="button" value="下一步" onclick="next()"/>
</body>
</html>
